---
layout: post
title: 'QSDK编译'
date: 2018-06-20 15:12:08
comments: true
tags:
  - OpenWRT
---

**QSDK** 是一种在openwrt的基础上，加入了高通atheros芯片相关资料的一种环境。

QSDK与OpenWRT的区别主要在如下几个方面：

- arch/mips/ath79/\* – updated QCA base platform device support – GPLv2
- sound/soc/ath79/\* – new ALSA-compliant QCA soundcard driver – ISC
- drivers/net/ethernet/atheros/ag71xx/\* – updated QCA Ethernet switch driver – GPLv2
- net/core/\* – performance enhancement updates to Linux sk_buff management – GPL v2
- drivers/spi – added modes to QCA spi driver – GPLv2
- drivers/mtd/nand/ – new QCA NAND flash controller driver – ISC

<!--more-->

编译步骤如下：（基于debian服务器）

1、安装开发所需软件：

```
sudo apt-get install gcc g++ binutils patch bzip2 flex make gettext pkg-config unzip zlib1g-dev libc6-dev subversion libncurses5-dev
sudo apt-get install gawk sharutils curl libxml-parser-perl ocaml-nox
```

2、安装repo和git

见 http://www.cnblogs.com/rohens-hbg/p/4916452.html

3、下载qsdk相关文件

```
repo init -u git://codeaurora.org/quic/qsdk/releases/manifest/qstak -b release -m  caf_AU_LINUX_QSDK_RELEASE_BANANA_SW_TARGET_ALL.2.7.029.xml
repo sync
mkdir -p qsdk/dl
tar xjvf qsdk-qca-wifi-2.7.029.tar.bz2 -C qsdk
tar xjvf qsdk-qca-wlan-2.7.029.tar.bz2 -C qsdk
tar xjvf qsdk-qca-shortcut-fe-2.7.029.tar.bz2 -c qsdk
```

4、编译

1.  cd qsdk

    make package/symlinks

2.  拷贝配置文件，目前该目录下有三个配置文件

    ar71xx*open.config
    ar71xx_premium.config ： 生成16m flash使用的bin文件
    ar71xx_wireless.config ： 生成8m flash使用的bin文件
    cp qca/configs/qca955x.ln/ar71xx*<profile>.config .config

3.  重新生成配置文件并build

    make defconfig
    make V=s

4.  去目录下去.bin文件download到设备上

    目录路径为：qsdk\bin\ar71xx

> 主要文件为：
> openwrt-ar71xx-generic-ap147-16M-kernel.bin (或 openwrt-ar71xx-generic-ap147-16M-kernel.bin)
> openwrt-ar71xx-generic-ap147-16M-rootfs-squashfs.bin (或 openwrt-ar71xx-generic-ap147-8M-rootfs-squashfs.bin)
